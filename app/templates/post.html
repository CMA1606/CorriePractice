{% extends 'base.html' %}

{% block body %}

{% if post %}
    {{moment(post.create_date).calendar()}} by {{post.author.fname}} {{post.author.lname}} 
    {% if post.modifydate %}
        modified {{moment(post.modifydate).calendar()}}
    {% endif %}
    <br>
    {% if post.author == current_user %}
        <a data-toggle="tooltip" data-placement="top" title="Delete Post" href="/post/delete/{{post.id}}">
            <img width="40" class="bottom-image" src="/static/delete.png">
        </a>
        <a data-toggle="tooltip" data-placement="top" title="Edit Post" href="/post/edit/{{post.id}}">
            <img width="40" class="bottom-image" src="/static/edit.png">
        </a>
    {% endif %}

    <h1 class="display-5" style="color: cornsilk;">{{post.subject}}</h1>
    <p class="fs-3 text-break" style="color: cornsilk;">
        {% if post.author.image %}
            <img width="120" class="img-thumbnail float-start me-2" src="data:image;base64,{{base64encode(post.author.image.read())}}">
        {% endif %}
            {{post.content}} <br>
            {{post.tag}}

    </p>

    <!-- The whole next section is for comments ON blog posts -->
    <!-- If you are using this as a template, you'll probably delete the whole comment section -->
    <a href="/comment/new/{{post.id}}" class="btn btn-primary btn-sm" role="button">New Comment</a>

    {% if comments %}
    <h1 class="display-5" style="color: cornsilk;">Comments</h1>
    {% for comment in comments %}
        {% if current_user == comment.author %}
            <a href="/comment/delete/{{comment.id}}"><img width="20" src="/static/delete.png"></a> 
            <a href="/comment/edit/{{comment.id}}"><img width="20" src="/static/edit.png"></a>
        {% endif %}

        <h5 style="color: cornsilk;">Author: {{comment.author.fname}} {{comment.author.lname}}
        {{moment(comment.create_date).calendar()}} {{comment.author.username}} 
        {% if comment.modifydate %}
            modified {{moment(comment.modifydate).calendar()}}
        {% endif %}
    </h5>
        <br>
        <p class="fs-3" style="color: cornsilk;">
            {{comment.content}}
        </p>
    {% endfor %}
    {% else %}
        <h1 class="display-5" style="color: cornsilk;">No Comments</h1>
    {% endif %}
    <!-- end of the comment section! -->
{% else %}

{% endif %}

{% endblock %}